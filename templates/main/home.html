{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ú–∞–≥–∞–∑–∏–Ω –º—è–≥–∫–∏—Ö –∏–≥—Ä—É—à–µ–∫</title>
    <link rel="stylesheet" href="{% static 'style.css' %}">
</head>
<body>
<header>
    <h1>–ú–∞–≥–∞–∑–∏–Ω –º—è–≥–∫–∏—Ö –∏–≥—Ä—É—à–µ–∫</h1>
    <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.username }}!</h2>

    <form method="get" action="{% url 'home' %}" style="display: inline-block; margin-left: 20px;">
        <input type="text" name="q" placeholder="–ü–æ–∏—Å–∫ –∏–≥—Ä—É—à–µ–∫..." value="{{ query|default:'' }}">
        <button type="submit">üîç</button>
    </form>

    <a href="{% url 'cart' %}" style="float: right; margin-right: 20px;">üõí –ö–æ—Ä–∑–∏–Ω–∞</a>
    <a href="{% url 'contact' %}" style="float: right; margin-right: 20px;">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
    <a href="{% url 'about' %}" style="float: right; margin-right: 20px;">–û –Ω–∞—Å</a>
</header>

<main style="display: flex; justify-content: space-between; align-items: flex-start; gap: 20px;">
    {% block content %}{% endblock %}

    {% if messages %}
<div id="toast-container">
    {% for message in messages %}
        <div class="toast">{{ message }}</div>
    {% endfor %}
</div>

<style>
/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤–Ω–∏–∑—É */
#toast-container {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 1000;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
}

/* –ö–∞–∂–¥—ã–π "—Ç–æ—Å—Ç" */
.toast {
    background: rgba(60, 60, 60, 0.9);
    color: #fff;
    padding: 12px 20px;
    border-radius: 10px;
    font-size: 15px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    opacity: 0;
    transform: translateY(20px);
    animation: toastFadeInOut 4s ease forwards;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –∏ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è */
@keyframes toastFadeInOut {
    0% {
        opacity: 0;
        transform: translateY(20px);
    }
    10% {
        opacity: 1;
        transform: translateY(0);
    }
    90% {
        opacity: 1;
        transform: translateY(0);
    }
    100% {
        opacity: 0;
        transform: translateY(20px);
    }
}
</style>
{% endif %}


<main style="display: flex; justify-content: space-between; align-items: flex-start; gap: 20px;">


    <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å ‚Äî —Ç–æ–≤–∞—Ä—ã -->
    <div class="toy-list" style="width: 70%;">
        {% if toys %}
            {% for toy in toys %}
            <div class="toy-card" style="border: 1px solid #ccc; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                <img src="{{ toy.image.url }}" alt="{{ toy.name }}" style="max-width: 150px; border-radius: 10px;">
                <h2>{{ toy.name }}</h2>
                <p>{{ toy.description }}</p>
                <p><strong>{{ toy.price }} ‚Ç∏</strong></p>

                {% if toy.tags.all %}
                    <p>
                        <strong>–¢–µ–≥–∏:</strong>
                        {% for tag in toy.tags.all %}
                            <span class="tag">#{{ tag.name }}</span>
                        {% endfor %}
                    </p>
                {% endif %}

                <!-- üîπ –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
                <div class="toy-buttons" style="display: flex; gap: 10px; margin-top: 10px;">
                    <!-- –ö–Ω–æ–ø–∫–∞ –ö—É–ø–∏—Ç—å -->
                    <form action="{% url 'buy_now' toy.id %}" method="post">
                        {% csrf_token %}
                        <button type="submit"
                                style="padding: 8px 12px; background: #4CAF50; color: white; border: none; border-radius: 6px; cursor: pointer;">
                            –ö—É–ø–∏—Ç—å
                        </button>
                    </form>

                    <!-- –ö–Ω–æ–ø–∫–∞ –í –∫–æ—Ä–∑–∏–Ω—É -->
                    <form action="{% url 'add_to_cart' toy.id %}" method="post">
                        {% csrf_token %}
                        <button type="submit"
                                style="padding: 8px 12px; background: #2196F3; color: white; border: none; border-radius: 6px; cursor: pointer;">
                            –í –∫–æ—Ä–∑–∏–Ω—É
                        </button>
                    </form>
                </div>
            </div>
            {% endfor %}
        {% else %}
            
        {% endif %}
    </div>
</main>
</body>
</html>

    <!-- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å ‚Äî –Ω–æ–≤–æ—Å—Ç–∏ -->
    <aside class="news-section" style="width: 25%; background: #f8f8f8; padding: 15px; border-radius: 10px;">
        {% if news_list %}
        <h3 style="text-align:center;">üì∞ –ù–æ–≤–æ—Å—Ç–∏</h3>
        {% for news in news_list %}
            <div class="news-item" style="margin-bottom: 15px; border-bottom: 1px solid #ddd; padding-bottom: 10px;">
                <h4 style="margin: 0;">{{ news.title }}</h4>
                <p style="font-size: 14px;">{{ news.content|truncatewords:20 }}</p>
                <small style="color: gray;">{{ news.created_at|date:"d.m.Y" }}</small>
            </div>
        {% empty %}
            <p>–ü–æ–∫–∞ –Ω–µ—Ç –Ω–æ–≤–æ—Å—Ç–µ–π.</p>
        {% endfor %}
        {% endif %}
    </aside>
</main>

<footer>
    <a href="{% url 'logout' %}" style="display:block;text-align:center;margin-top:20px;">–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞</a>
    <p>¬© 2025 –ú–æ–π –º–∞–≥–∞–∑–∏–Ω –∏–≥—Ä—É—à–µ–∫</p>
</footer>
</body>
</html>
